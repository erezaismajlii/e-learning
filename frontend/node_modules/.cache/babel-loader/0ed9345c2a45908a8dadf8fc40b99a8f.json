{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC2\\\\Desktop\\\\_blgashLMS\\\\frontend\\\\src\\\\components\\\\ListeningAdmin\\\\CreateListen\\\\data.js\",\n    _s = $RefreshSig$();\n\nimport listeningApi from 'apis/listeningApi';\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux'; // import { messageReducer } from '/src/redux/reducers/messageReducer';\n\nimport CreateListening from './index';\nimport { setMessage } from 'redux/actions/messageAction'; //import messageReducer from 'redux/reducers/messageReducer';\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst analysisLinkVideo = function () {\n  let linkVideo = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n  if (typeof linkVideo !== 'string' || linkVideo === '') {\n    return null;\n  }\n\n  let checkVid = linkVideo.includes(\"https://www.youtube.com\");\n\n  if (!checkVid) {\n    checkVid = linkVideo.includes(\"youtu.be/\");\n\n    if (checkVid) {\n      return linkVideo;\n    }\n\n    return null;\n  }\n\n  return linkVideo;\n};\n\nfunction CreateListeningData() {\n  _s();\n\n  const [submitting, setSubmitting] = useState(false);\n  const dispatch = useDispatch();\n\n  const handleSubmit = async data => {\n    try {\n      setSubmitting(true);\n      const {\n        VidUpload,\n        LinkVideo,\n        ...rest\n      } = data;\n\n      if (VidUpload && LinkVideo && LinkVideo.trim() != \"\") {\n        dispatch(setMessage(\"Chọn một trong hai tùy chọn để thêm video\", \"warning\"));\n        setSubmitting(false);\n        return;\n      }\n\n      let dataSend = [];\n      console.log(data);\n\n      if (VidUpload == null) {\n        //  console.log(data)\n        const videoUrl = analysisLinkVideo(LinkVideo);\n\n        if (videoUrl == null) {\n          dispatch(setMessage(\"Link video is invalid.\", \"warning\"));\n          setSubmitting(false);\n          return;\n        }\n\n        dataSend = { ...rest,\n          Video: videoUrl\n        };\n      } else {\n        dataSend = { ...rest,\n          Video: VidUpload\n        };\n      }\n\n      const apiRes = await listeningApi.postListen(dataSend);\n      console.log(apiRes.data);\n\n      if (apiRes.status === 200) {\n        dispatch(setMessage(\"Created listening successfully\", \"success\"));\n        setSubmitting(false);\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n\n      const message = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Error, can not create listening.';\n      dispatch(setMessage(message, \"error\"));\n      setSubmitting(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(CreateListening, {\n    onSubmitForm: handleSubmit,\n    submitting: submitting\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreateListeningData, \"5iB+qujXnQj6jBoSGKljUlKKZP8=\", false, function () {\n  return [useDispatch];\n});\n\n_c = CreateListeningData;\nexport default CreateListeningData;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateListeningData\");","map":{"version":3,"names":["listeningApi","React","useState","useEffect","useDispatch","useSelector","CreateListening","setMessage","analysisLinkVideo","linkVideo","checkVid","includes","CreateListeningData","submitting","setSubmitting","dispatch","handleSubmit","data","VidUpload","LinkVideo","rest","trim","dataSend","console","log","videoUrl","Video","apiRes","postListen","status","error","message","response"],"sources":["C:/Users/PC2/Desktop/_blgashLMS/frontend/src/components/ListeningAdmin/CreateListen/data.js"],"sourcesContent":["import listeningApi from 'apis/listeningApi';\nimport React, { useState, useEffect  } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n// import { messageReducer } from '/src/redux/reducers/messageReducer';\nimport CreateListening from './index';\nimport { setMessage } from 'redux/actions/messageAction';\n//import messageReducer from 'redux/reducers/messageReducer';\n\nconst analysisLinkVideo = (linkVideo = '') => {\n  if (typeof linkVideo !== 'string' || linkVideo === '') {\n    return null;\n  }\n\n  let checkVid = linkVideo.includes(\"https://www.youtube.com\")\n  if(!checkVid){\n      checkVid =linkVideo.includes(\"youtu.be/\")\n      if(checkVid)\n      {\n        return linkVideo;\n      }\n      return null;\n  }\n  return linkVideo;\n};\n\n\nfunction CreateListeningData() {\n  const [submitting, setSubmitting] = useState(false);\n  const dispatch = useDispatch();\n\n\n  const handleSubmit = async (data) => {\n    try {\n      setSubmitting(true);\n      const { VidUpload, LinkVideo, ...rest } = data;\n\n      if (VidUpload && LinkVideo && LinkVideo.trim()!=\"\"){\n        dispatch(setMessage(\"Chọn một trong hai tùy chọn để thêm video\", \"warning\"));\n        setSubmitting(false);\n        return;\n      }\n\n      let dataSend = []\n      console.log(data);\n      if(VidUpload == null){\n      //  console.log(data)\n        const videoUrl = analysisLinkVideo(LinkVideo);\n        if (videoUrl==null) {\n          dispatch(setMessage(\"Link video is invalid.\", \"warning\"));\n          setSubmitting(false);\n          return;\n        }\n        dataSend ={\n          ...rest,\n         Video: videoUrl,\n        };\n      }\n      else{\n        dataSend ={\n          ...rest,\n         Video: VidUpload,\n        };  \n      }     \n      const apiRes = await listeningApi.postListen(dataSend);\n      console.log(apiRes.data)\n      if (apiRes.status === 200) {\n        dispatch(setMessage(\"Created listening successfully\", \"success\"));\n        setSubmitting(false);\n     }\n\n    } catch (error) {\n      const message =  error.response?.data?.message ||\n      'Error, can not create listening.';\n        dispatch(setMessage(message, \"error\"));\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <CreateListening onSubmitForm={handleSubmit} submitting={submitting} />\n  );\n}\n\nexport default CreateListeningData;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}